<!DOCTYPE html>
<html>
  <head>
    <title>Mode Terang & Gelap</title>
    <style>
      /* Gaya untuk mode terang */
      body {
        background-color: #ffffff;
        color: #000000;
      }

      /* Gaya untuk mode gelap */
      body.dark-mode {
        background-color: #000000;
        color: #ffffff;
      }
    </style>
  </head>
  <body>
    <button id="toggleButton">Toggle Mode</button>

    <script>
      const toggleButton = document.getElementById('toggleButton');
      const body = document.body;

      async function openDB() {
        return new Promise((resolve, reject) => {
          const request = indexedDB.open('modeDB', 1);

          request.onupgradeneeded = (event) => {
            const db = event.target.result;
            if (!db.objectStoreNames.contains('modeStore')) {
              db.createObjectStore('modeStore', { keyPath: 'id' });
            }
          };

          request.onsuccess = () => {
            resolve(request.result);
          };

          request.onerror = () => {
            reject(request.error);
          };
        });
      }

      async function getMode() {
        const db = await openDB();
        return new Promise((resolve, reject) => {
          const transaction = db.transaction(['modeStore'], 'readonly');
          const store = transaction.objectStore('modeStore');
          const request = store.get(1);
          request.onsuccess = () => {
            resolve(request.result ? request.result.value : null);
          };
          request.onerror = () => {
            reject(request.error);
          };
        });
      }

      async function setMode(mode) {
        const db = await openDB();
        return new Promise((resolve, reject) => {
          const transaction = db.transaction(['modeStore'], 'readwrite');
          const store = transaction.objectStore('modeStore');
          const request = store.put({ id: 1, value: mode });
          request.onsuccess = () => {
            resolve();
          };
          request.onerror = () => {
            reject(request.error);
          };
        });
      }

      async function applyMode() {
        const mode = await getMode();
        if (mode === 'dark-mode') {
          body.classList.add('dark-mode');
        } else {
          body.classList.remove('dark-mode');
        }
      }

      async function toggleMode() {
        if (body.classList.contains('dark-mode')) {
          await setMode('light-mode');
        } else {
          await setMode('dark-mode');
        }
        applyMode();
      }

      toggleButton.addEventListener('click', toggleMode);

      // Menerapkan mode saat halaman dimuat
      applyMode();
    </script>
  </body>
</html>
